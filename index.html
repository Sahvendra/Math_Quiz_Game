<!doctype html>
<!--
  Math Quiz â€” IWT College Assignment
  Single-file HTML/CSS/JS game. Save as math-quiz-iwt.html and open in browser.

  Features:
  - Start screen with name & settings (difficulty, number of questions, types)
  - Random question generator (add, sub, mul, div)
  - Multiple-choice answers (4 choices) + optional numeric input mode
  - Per-question timer and overall progress
  - Score, streaks, and simple animations
  - High-score stored in localStorage
  - Accessible (keyboard), responsive layout

  Author: Generated by ChatGPT (GPT-5 Thinking mini)
-->
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Math Quiz - IWT Assignment</title>
  <style>
    :root{
      --bg:#0f1724; --card:#0b1220; --accent:#7dd3fc; --muted:#94a3b8; --success:#10b981; --danger:#ef4444;
      --glass: rgba(255,255,255,0.03);
      font-family: Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; background:linear-gradient(180deg,#071024 0%, #07162b 100%); color:#e6eef8; display:flex; align-items:center; justify-content:center; padding:24px;
    }
    .container{width:100%; max-width:900px}
    .card{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01)); border-radius:12px; padding:22px; box-shadow:0 6px 24px rgba(2,6,23,0.6);}
    header{display:flex; align-items:center; justify-content:space-between; gap:12px}
    header h1{margin:0; font-size:20px}
    .meta{color:var(--muted); font-size:13px}

    .layout{display:grid; grid-template-columns: 1fr 360px; gap:18px; margin-top:18px}
    @media (max-width:880px){ .layout{grid-template-columns:1fr} .aside{order:2} }

    .main{background:var(--card); padding:18px; border-radius:10px}
    .aside{background:var(--card); padding:18px; border-radius:10px}

    .center{display:flex; align-items:center; justify-content:center; flex-direction:column; gap:10px; min-height:220px}

    .btn{background:transparent;border:1px solid rgba(125,211,252,0.12); padding:10px 14px; border-radius:8px; cursor:pointer; color:var(--accent);}
    .btn.primary{background:linear-gradient(90deg,var(--accent),#60a5fa); color:#012; border:none}

    .controls{display:flex; gap:8px; flex-wrap:wrap}
    label{display:block; font-size:13px; color:var(--muted)}
    input[type=text],select,input[type=number]{width:100%; padding:8px 10px; border-radius:8px; border:1px solid rgba(255,255,255,0.04); background:transparent; color:inherit}

    .question{font-size:22px; font-weight:600}
    .choices{display:grid; grid-template-columns:1fr 1fr; gap:8px; margin-top:12px}
    .choice{padding:10px; border-radius:8px; background:var(--glass); cursor:pointer; border:1px solid rgba(255,255,255,0.02);}
    .choice.correct{outline:3px solid rgba(16,185,129,0.15); background:linear-gradient(90deg, rgba(16,185,129,0.06), transparent)}
    .choice.wrong{outline:3px solid rgba(239,68,68,0.12); background:linear-gradient(90deg, rgba(239,68,68,0.04), transparent)}

    .small{font-size:13px; color:var(--muted)}

    .progress{height:10px; background:rgba(255,255,255,0.03); border-radius:999px; overflow:hidden}
    .progress > i{display:block; height:100%; background:linear-gradient(90deg,var(--accent), #60a5fa); width:0%}

    .stats{display:flex; gap:8px; flex-wrap:wrap}
    .stat{padding:8px 10px; background:rgba(255,255,255,0.02); border-radius:8px; font-size:14px}

    footer{display:flex; gap:8px; margin-top:12px; align-items:center}

    /* subtle animations */
    .fade-in{animation:fadeIn .32s ease both}
    @keyframes fadeIn{from{opacity:0; transform:translateY(6px)} to{opacity:1; transform:none}}

    .center img{max-width:140px; opacity:0.12}

    .access{display:flex; gap:6px; align-items:center}
    .hint{font-size:13px; color:var(--muted)}
  </style>
</head>
<body>
  <div class="container">
    <div class="card">
      <header>
        <div>
          <h1>Math Quiz â€” IWT Assignment</h1>
          <div class="meta">Practice arithmetic & logic â€” responsive, accessible, and saved highscore</div>
        </div>
        <div class="meta">Student: __________ &nbsp; | &nbsp; Course: IWT</div>
      </header>

      <div class="layout">
        <section class="main">
          <div id="startScreen" class="center fade-in">
            <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='120' height='120' viewBox='0 0 24 24'%3E%3Cpath fill='%237dd3fc' d='M12 2a10 10 0 1 0 10 10A10.011 10.011 0 0 0 12 2Zm1 14h-2v-2h2Zm0-4h-2V7h2Z'/%3E%3C/svg%3E" alt="math"/>
            <div style="width:100%; max-width:560px">
              <label class="small">Your name (for highscore)</label>
              <input id="playerName" type="text" placeholder="Enter your name" />

              <div style="height:12px"></div>

              <div class="controls">
                <div style="min-width:160px">
                  <label class="small">Difficulty</label>
                  <select id="difficulty"><option value="easy">Easy</option><option value="medium" selected>Medium</option><option value="hard">Hard</option></select>
                </div>
                <div style="min-width:160px">
                  <label class="small">Number of Questions</label>
                  <input id="qCount" type="number" min="5" max="30" value="10" />
                </div>
                <div style="min-width:140px">
                  <label class="small">Question Types</label>
                  <select id="qTypes" multiple size="4" style="height:98px">
                    <option value="add" selected>Addition (+)</option>
                    <option value="sub" selected>Subtraction (-)</option>
                    <option value="mul" selected>Multiplication (Ã—)</option>
                    <option value="div">Division (Ã·)</option>
                  </select>
                  <div class="small">(Hold Ctrl/Cmd to select multiple)</div>
                </div>
              </div>

              <div style="height:12px"></div>
              <div style="display:flex; gap:8px">
                <button id="startBtn" class="btn primary">Start Quiz</button>
                <button id="howBtn" class="btn">How to play</button>
                <button id="resetHigh" class="btn">Reset Highscore</button>
              </div>
            </div>
          </div>

          <div id="gameScreen" class="fade-in" style="display:none">
            <div style="display:flex; justify-content:space-between; align-items:center; gap:10px">
              <div>
                <div class="small">Player: <span id="playerLabel">-</span></div>
                <div class="question" id="questionText">Question will appear here</div>
              </div>
              <div style="text-align:right">
                <div class="small">Time left</div>
                <div id="timer" style="font-weight:700; font-size:18px">00</div>
              </div>
            </div>

            <div class="choices" id="choices"></div>

            <div style="margin-top:12px; display:flex; gap:10px; align-items:center; justify-content:space-between">
              <div class="stats">
                <div class="stat">Score: <span id="score">0</span></div>
                <div class="stat">Question: <span id="qNum">0</span>/<span id="qTotal">0</span></div>
                <div class="stat">Streak: <span id="streak">0</span></div>
              </div>

              <div style="flex:1; margin-left:12px">
                <div class="progress" aria-hidden="true"><i id="progBar"></i></div>
              </div>

              <div>
                <button id="nextBtn" class="btn" disabled>Next</button>
                <button id="quitBtn" class="btn">Quit</button>
              </div>
            </div>

            <footer>
              <div class="hint">Press 1-4 to answer choices. Use keyboard for accessibility.</div>
            </footer>
          </div>

          <div id="endScreen" class="center" style="display:none">
            <div>
              <h2>Quiz Complete ðŸŽ‰</h2>
              <div class="small">Final Score: <strong id="finalScore">0</strong></div>
              <div class="small">Correct: <strong id="finalCorrect">0</strong> | Incorrect: <strong id="finalWrong">0</strong></div>
              <div style="height:8px"></div>
              <div class="small">Highscore: <strong id="bestLabel">-</strong></div>
              <div style="height:12px"></div>
              <div style="display:flex; gap:8px; justify-content:center">
                <button id="retryBtn" class="btn primary">Play Again</button>
                <button id="toStart" class="btn">Back to Start</button>
              </div>
            </div>
          </div>

        </section>

        <aside class="aside">
          <div style="display:flex; justify-content:space-between; align-items:center">
            <div>
              <div class="small">Highscore</div>
              <div style="font-weight:700; font-size:18px" id="highscoreText">-</div>
            </div>
            <div style="text-align:right">
              <div class="small">Difficulty</div>
              <div id="highDiff" class="small">-</div>
            </div>
          </div>

          <div style="height:12px"></div>
          <div class="small">Recent attempts</div>
          <div id="recent" style="margin-top:8px; display:flex; flex-direction:column; gap:6px"></div>

          <div style="height:16px"></div>
          <div class="small">Controls & Tips</div>
          <ul class="small">
            <li>Answer with mouse or keys 1â€“4</li>
            <li>Each correct gives +10 points, quick answers bonus</li>
            <li>Division questions give rounded results</li>
            <li>Use multiple-choice selection for easy grading</li>
          </ul>
        </aside>
      </div>

    </div>
  </div>

  <script>
    // --- Utilities ---
    const qs = (s, root=document) => root.querySelector(s);
    const qsa = (s, root=document) => Array.from(root.querySelectorAll(s));

    // DOM
    const startScreen = qs('#startScreen');
    const gameScreen = qs('#gameScreen');
    const endScreen = qs('#endScreen');
    const startBtn = qs('#startBtn');
    const howBtn = qs('#howBtn');
    const retryBtn = qs('#retryBtn');
    const toStart = qs('#toStart');
    const playerNameInp = qs('#playerName');
    const difficultySel = qs('#difficulty');
    const qCountInp = qs('#qCount');
    const qTypesSel = qs('#qTypes');
    const scoreEl = qs('#score');
    const qNumEl = qs('#qNum');
    const qTotalEl = qs('#qTotal');
    const choicesEl = qs('#choices');
    const questionText = qs('#questionText');
    const timerEl = qs('#timer');
    const prog = qs('#progBar');
    const nextBtn = qs('#nextBtn');
    const quitBtn = qs('#quitBtn');
    const finalScore = qs('#finalScore');
    const finalCorrect = qs('#finalCorrect');
    const finalWrong = qs('#finalWrong');
    const bestLabel = qs('#bestLabel');
    const highscoreText = qs('#highscoreText');
    const highDiff = qs('#highDiff');
    const recentDiv = qs('#recent');
    const resetHigh = qs('#resetHigh');

    // Game state
    let state = {
      player: '',
      difficulty: 'medium',
      total: 10,
      types: ['add','sub','mul'],
      questions: [],
      current: 0,
      score: 0,
      correct:0,
      wrong:0,
      streak:0,
      timer: null,
      timePerQ: 15,
      timeLeft:0
    };

    // Local storage keys
    const STORAGE_KEY = 'iwt_math_quiz_v1';

    // Helper: load & save highscores
    function loadStorage(){
      try{ return JSON.parse(localStorage.getItem(STORAGE_KEY) || '{}'); }catch(e){return{}}
    }
    function saveStorage(data){ localStorage.setItem(STORAGE_KEY, JSON.stringify(data)); }

    function updateHighscoreUI(){
      const data = loadStorage();
      if(data.best){
        highscoreText.textContent = data.best.score + ' by ' + data.best.name;
        bestLabel.textContent = data.best.score + ' ('+data.best.name+')';
        highDiff.textContent = data.best.difficulty || '-';
      } else {
        highscoreText.textContent = '-'; bestLabel.textContent='-'; highDiff.textContent='-';
      }
      // recent
      recentDiv.innerHTML = '';
      (data.recent||[]).slice(-5).reverse().forEach(r=>{
        const el = document.createElement('div'); el.className='small'; el.textContent = r.name + ' â€” ' + r.score + ' ('+r.difficulty+')';
        recentDiv.appendChild(el);
      });
    }

    resetHigh.addEventListener('click', ()=>{
      if(confirm('Reset saved highscore and attempts?')){ localStorage.removeItem(STORAGE_KEY); updateHighscoreUI(); }
    });

    updateHighscoreUI();

    // --- Question generator ---
    function randInt(min,max){ return Math.floor(Math.random()*(max-min+1))+min; }

    function makeQuestion(difficulty, types){
      // difficulty affects operand ranges and time
      let ranges = {easy: [1,12], medium: [2,20], hard: [5,50]};
      state.timePerQ = ({easy:18, medium:15, hard:12})[difficulty] || 15;
      const [lo,hi] = ranges[difficulty] || ranges.medium;
      const type = types[Math.floor(Math.random()*types.length)];
      let a = randInt(lo, hi);
      let b = randInt(lo, hi);
      let text = '';
      let answer = 0;

      if(type === 'add'){
        text = `${a} + ${b}`; answer = a + b;
      } else if(type === 'sub'){
        if(b>a) [a,b]=[b,a]; text=`${a} - ${b}`; answer = a - b;
      } else if(type === 'mul'){
        text = `${a} Ã— ${b}`; answer = a * b;
      } else if(type === 'div'){
        // ensure divisible or give 2-decimal rounding
        answer = Math.round((a / b) * 100) / 100; // 2 decimal
        text = `${a} Ã· ${b}`;
      }
      // create choices
      const choices = new Set(); choices.add(answer);
      while(choices.size < 4){
        const perturb = randInt(1, Math.max(2, Math.round(Math.abs(answer)/3 || 3)));
        const sign = Math.random()<0.5? -1:1;
        let cand = (typeof answer === 'number' && !Number.isInteger(answer)) ? Math.round((answer + sign*perturb/10)*100)/100 : answer + sign*perturb;
        // avoid negatives for easy
        if(difficulty==='easy' && typeof cand === 'number' && cand<0) cand = Math.abs(cand);
        choices.add(cand);
      }

      const arr = Array.from(choices);
      // shuffle
      for(let i=arr.length-1;i>0;i--){ const j=randInt(0,i); [arr[i],arr[j]]=[arr[j],arr[i]]; }

      return {text, answer, choices:arr, type};
    }

    // Build questions list
    function buildQuestions(){
      const types = Array.from(qTypesSel.selectedOptions).map(o=>o.value);
      if(types.length===0) types.push('add');
      const diff = difficultySel.value;
      const total = Math.max(5, Math.min(30, parseInt(qCountInp.value) || 10));
      state.difficulty = diff; state.total = total; state.types = types;
      state.questions = Array.from({length:total}, ()=> makeQuestion(diff, types));
      state.current = 0; state.score=0; state.correct=0; state.wrong=0; state.streak=0;
    }

    // --- Rendering & flow ---
    function showScreen(screen){ startScreen.style.display='none'; gameScreen.style.display='none'; endScreen.style.display='none'; screen.style.display='flex'; }

    startBtn.addEventListener('click', ()=>{
      state.player = (playerNameInp.value || 'Anonymous').trim();
      buildQuestions();
      qs('#playerLabel').textContent = state.player;
      qTotalEl.textContent = state.total;
      qNumEl.textContent = 0;
      scoreEl.textContent = 0;
      showScreen(gameScreen);
      renderQuestion();
    });

    howBtn.addEventListener('click', ()=>{
      alert('Choose difficulty, number of questions, select question types (Ctrl/Cmd to pick multiple). Start the quiz and answer using mouse or keys 1-4.');
    });

    quitBtn.addEventListener('click', ()=>{
      if(confirm('Quit quiz and return to start?')){ showScreen(startScreen); }
    });

    retryBtn.addEventListener('click', ()=>{ showStartWithPrev(); startBtn.click(); });
    toStart.addEventListener('click', ()=>{ showStartWithPrev(); });

    function showStartWithPrev(){ showScreen(startScreen); }

    function renderQuestion(){
      clearInterval(state.timer); nextBtn.disabled=true; choicesEl.innerHTML='';
      if(state.current >= state.questions.length){ endGame(); return; }
      const q = state.questions[state.current];
      questionText.textContent = q.text;
      qNumEl.textContent = state.current + 1;
      // choices
      q.choices.forEach((c,i)=>{
        const btn = document.createElement('button'); btn.className='choice'; btn.tabIndex=0; btn.dataset.index=i;
        btn.innerHTML = `<strong>${['a','b','c','d'][i]}.</strong> &nbsp; <span>${c}</span>`;
        btn.addEventListener('click', ()=> selectAnswer(i));
        choicesEl.appendChild(btn);
      });

      // progress bar
      const pct = Math.round((state.current / state.questions.length) * 100);
      prog.style.width = pct + '%';

      // start timer
      state.timeLeft = state.timePerQ;
      timerEl.textContent = state.timeLeft;
      state.timer = setInterval(()=>{
        state.timeLeft--; timerEl.textContent = state.timeLeft;
        if(state.timeLeft<=0){ clearInterval(state.timer); handleTimeout(); }
      }, 1000);

      // keyboard listeners
      document.onkeydown = (e)=>{
        if(e.key >= '1' && e.key <= '4'){
          const idx = parseInt(e.key)-1; if(idx < q.choices.length) selectAnswer(idx);
        } else if(e.key === 'Enter' && !nextBtn.disabled){ nextBtn.click(); }
      };
    }

    function selectAnswer(idx){
      if(!state.questions[state.current]) return;
      const q = state.questions[state.current];
      clearInterval(state.timer);
      const chosen = q.choices[idx];
      const buttons = qsa('.choice');
      buttons.forEach((b,i)=>{
        b.classList.remove('correct','wrong'); b.disabled=true;
        const val = q.choices[i];
        if(val == q.answer) b.classList.add('correct');
        if(i===idx && val != q.answer) b.classList.add('wrong');
      });

      // scoring
      if(chosen == q.answer){
        const timeBonus = Math.max(0, Math.floor(state.timeLeft));
        const base = 10; state.score += base + timeBonus; state.correct++; state.streak++;
      } else { state.wrong++; state.streak=0; }

      scoreEl.textContent = state.score; qs('#streak').textContent = state.streak;
      nextBtn.disabled = false;
      nextBtn.onclick = ()=>{
        state.current++; renderQuestion();
      };
    }

    function handleTimeout(){
      const q = state.questions[state.current];
      const buttons = qsa('.choice');
      buttons.forEach((b,i)=>{ b.disabled=true; if(q.choices[i]==q.answer) b.classList.add('correct'); });
      state.wrong++; state.streak=0; nextBtn.disabled=false;
      nextBtn.onclick = ()=>{ state.current++; renderQuestion(); };
    }

    function endGame(){
      clearInterval(state.timer); showScreen(endScreen);
      finalScore.textContent = state.score; finalCorrect.textContent = state.correct; finalWrong.textContent = state.wrong;
      // save to storage
      const data = loadStorage();
      data.recent = data.recent || [];
      data.recent.push({name: state.player, score: state.score, difficulty: state.difficulty, date: Date.now()});
      if(!data.best || state.score > data.best.score){ data.best = {name: state.player, score: state.score, difficulty: state.difficulty, date:Date.now()}; }
      // keep recent length
      if(data.recent.length>20) data.recent = data.recent.slice(-20);
      saveStorage(data);
      updateHighscoreUI();
    }

    // quick start if user presses Enter on player name
    playerNameInp.addEventListener('keydown', (e)=>{ if(e.key==='Enter') startBtn.click(); });

    // init
    showScreen(startScreen);

  </script>
</body>
</html>
